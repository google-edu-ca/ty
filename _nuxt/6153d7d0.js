import{e as q}from"./f41cdebb.js";import{E,p as M,o as n,g as m,b as o,t as _,n as b,l as p}from"./entry.045c8965.js";const N={key:0,id:"unity-container",class:"unity-desktop full_game"},B=o("div",{class:"game-content"},[o("canvas",{id:"unity-canvas"})],-1),L={id:"unity-loading-bar"},$={id:"unity-logo",class:"logo"},x=["src"],V=o("div",{class:"percent"},"Загрузка: 0.0%",-1),F=o("div",{id:"unity-progress-bar-empty",class:"progressbar"},[o("div",{id:"unity-progress-bar-full",class:"progressfull"})],-1),G={key:1,class:"webgl-content unity-desktop full_game"},H=o("div",{class:"game-content",id:"unityContainer",style:{width:"100%",height:"100%"}},null,-1),T={id:"unity-logo",class:"logo"},z=["src"],A=o("div",{class:"percent"},"Загрузка: 0.0%",-1),D={key:2,id:"unity5_4"},j={__name:"Unity",props:["post"],emits:["is_load"],setup(r,{emit:v}){const t=r,w=v,d=q();E(d,s=>{s==!0&&y()}),M(()=>{t.post.game.fields.unity_script_head&&u(t.post.game.fields.unity_script_head,"head"),d.value==!0&&y()});const c=()=>{w("is_load")},y=()=>{t.post.game.fields.unitywebglbuildurl?S():t.post.game.fields.dataurl?k():t.post.game.fields.unityprogress&&U(),d.value==!d.value},u=(s,l)=>{const e=document.createElement("script");e.src=s,l=="head"&&document.head.appendChild(e),l=="body"&&document.body.prepend(e)},f=()=>{t.post.game.fields.unity_script_head_2&&u(t.post.game.fields.unity_script_head_2,"head"),t.post.game.fields.unity_script_head_3&&u(t.post.game.fields.unity_script_head_3,"body")},S=()=>{function s(e,i){e.Module&&(e.logo||(e.logo=document.createElement("div"),e.logo.className="logo "+e.Module.splashScreenStyle,e.container.appendChild(e.logo)),e.progress||(e.progress=document.createElement("div"),e.progress.className="progress "+e.Module.splashScreenStyle,e.progress.empty=document.createElement("div"),e.progress.empty.className="empty",e.progress.appendChild(e.progress.empty),e.progress.full=document.createElement("div"),e.progress.full.className="full",e.progress.appendChild(e.progress.full),e.container.appendChild(e.progress)),document.querySelector(".percent").innerHTML="Загрузка: "+(100*i).toFixed(1)+"%",e.progress.full.style.width=100*i+"%",e.progress.empty.style.width=100*(1-i)+"%",i>.01&&c(),i==1&&(e.logo.style.display=e.progress.style.display="none",document.querySelector(".cover_back").style.display="none",document.querySelector("#unity-logo").style.display="none"))}var l=document.createElement("script");l.src=t.post.game.fields.unitywebglloaderurl,l.onload=()=>{UnityLoader.SystemInfo.mobile=!1;var e=UnityLoader.instantiate("unityContainer",t.post.game.fields.unitywebglbuildurl,{onProgress:s,Module:{onRuntimeInitialized:function(){s(e,"complete"),window.unityGlobal=e,f()}}})},document.body.appendChild(l)},k=()=>{function s(){var l=t.post.game.fields.unitywebglloaderurl,e={dataUrl:t.post.game.fields.dataurl,frameworkUrl:t.post.game.fields.frameworkurl,codeUrl:t.post.game.fields.codeurl,memoryUrl:t.post.game.fields.memoryurl?t.post.game.fields.memoryurl:"",symbolsUrl:t.post.game.fields.symbolsurl?t.post.game.fields.symbolsurl:"",streamingAssetsUrl:t.post.game.fields.streamingassetsurl?t.post.game.fields.streamingassetsurl:"StreamingAssets",companyName:"DefaultCompany",productVersion:"1.0"};document.querySelector("#unity-container");var i=document.querySelector("#unity-canvas"),h=document.querySelector("#unity-loading-bar"),C=document.querySelector("#unity-progress-bar-full");document.querySelector("#unity-mobile-warning"),i.style.width="100%",i.style.height="100%",h.style.display="block";var g=document.createElement("script");g.src=l,g.onload=()=>{createUnityInstance(i,e,a=>{C.style.width=100*a+"%",document.querySelector(".percent").innerHTML="Загрузка: "+(100*a).toFixed(1)+"%",a>.01&&c()}).then(a=>{h.style.display="none",window.unityGlobal=a,f()}).catch(a=>{alert(a)})},document.body.appendChild(g)}s()},U=()=>{let s="https://m.igroutka.ru/run/?unity";if(t.post.game.fields.iframegameheight&&(s+=`&iframegameheight=${t.post.game.fields.iframegameheight}`),t.post.game.fields.iframegamewidth&&(s+=`&iframegamewidth=${t.post.game.fields.iframegamewidth}`),t.post.game.fields.unityprogress&&(s+=`&unityprogress=${t.post.game.fields.unityprogress}`),t.post.game.fields.unitywebglloaderurl&&(s+=`&unitywebglloaderurl=${t.post.game.fields.unitywebglloaderurl}`),t.post.game.title&&(s+=`&title=${t.post.game.title}`),t.post.game.fields.unitymodule){const i=btoa(t.post.game.fields.unitymodule);s+=`&unitymodule=${i}`}const l=document.getElementById("unity5_4"),e='<iframe onload="'+c()+'" src="'+s+'" width="100%" height="100%" scrolling="no" frameborder="0" allowfullscreen="true"></iframe>';l.innerHTML=e};return(s,l)=>(n(),m("div",null,[r.post.game.fields.dataurl?(n(),m("div",N,[B,o("div",L,[o("div",$,[o("img",{src:r.post.game.image,width:"160",height:"160"},null,8,x),o("h2",null,_(r.post.game.title),1),V]),F]),o("div",{style:b("background-image: url("+r.post.game.image+")"),class:"cover_back"},null,4)])):p("",!0),r.post.game.fields.unitywebglbuildurl?(n(),m("div",G,[H,o("div",T,[o("img",{src:r.post.game.image,width:"160",height:"160"},null,8,z),o("h2",null,_(r.post.game.title),1),A]),o("div",{style:b("background-image: url("+r.post.game.image+")"),class:"cover_back"},null,4)])):p("",!0),r.post.game.fields.unityprogress?(n(),m("div",D)):p("",!0)]))}};export{j as default};
